#macro(getMessage $code)$messageSource.getMessage($code, null, $locale)#end

<form>
  <view>
    <name>Participant</name>
    <caption>#getMessage("participant")</caption>
    <table>CPR_VIEW</table>
    <primaryKey>CPR_ID</primaryKey>
    <activeCondition>ACTIVITY_STATUS != 'Disabled'</activeCondition>  
    <row>
      <numberField>
        <name>participantId</name>
        <udn>participantId</udn>
        <caption>#getMessage("participant_id")</caption>
        <column>PARTICIPANT_ID</column>
      </numberField>
    </row>
    <row>
      <textField>
        <name>firstName</name>
        <udn>firstName</udn>
        <caption>#getMessage("participant_first_name")</caption>
        <column>FIRST_NAME</column>
        <maxLength>50</maxLength>
        <phi>true</phi>
      </textField>

      <textField>
        <name>middleName</name>
        <udn>middleName</udn>
        <caption>#getMessage("participant_middle_name")</caption>
        <column>MIDDLE_NAME</column>
        <maxLength>50</maxLength>
        <phi>true</phi>
      </textField>

      <textField>
        <name>lastName</name>
        <udn>lastName</udn>
        <caption>#getMessage("participant_last_name")</caption>
        <column>LAST_NAME</column>
        <phi>true</phi>
      </textField>
    </row>
    <row>
      <datePicker>
        <name>dateOfBirth</name>
        <udn>dateOfBirth</udn>
        <caption>#getMessage("participant_dob")</caption>
        <column>DOB</column>
        <format>MM-dd-yyyy</format>
        <phi>true</phi>
      </datePicker>
    </row>
    <row>
      <datePicker>
        <name>deathDate</name>
        <udn>deathDate</udn>
        <caption>#getMessage("participant_death_date")</caption>
        <column>DEATH_DATE</column>
        <format>MM-dd-yyyy</format>
        <phi>true</phi>
      </datePicker>
    </row>
    <row>
      <textField>
        <name>ssn</name>
        <udn>ssn</udn>
        <caption>#getMessage("participant_ssn")</caption>
        <column>SSN</column>
        <phi>true</phi>
      </textField>
    </row>
    <row>
      <textField>
        <name>empi</name>
        <udn>empi</udn>
        <caption>#getMessage("participant_empi")</caption>
        <column>EMPI_ID</column>
        <phi>true</phi>
      </textField>
    </row>
    <row>
      <textField>
        <name>vitalStatus</name>
        <udn>vitalStatus</udn>
        <caption>#getMessage("participant_vital_status")</caption>
        <column>VITAL_STATUS</column>
      </textField>
    </row>
    <row>
      <dropDown>
        <name>activityStatus</name>
        <udn>activityStatus</udn>
        <caption>#getMessage("participant_activity_status")</caption>
        <column>ACTIVITY_STATUS</column>
        <options>
          <option><value>Active</value></option>
          <option><value>Disabled</value></option>
          <option><value>Closed</value></option>
        </options>
      </dropDown>
    </row>
    <row>
      <radioButton>
        <name>gender</name>
        <udn>gender</udn>
        <caption>#getMessage("participant_gender")</caption>
        <column>GENDER</column>
        <options>
          <sql>select value from catissue_permissible_value where public_id = 'gender' order by value</sql>
        </options>
      </radioButton>
    </row>
    <row>
      <checkBox>
        <name>race</name>
        <udn>race</udn>
        <caption>#getMessage("participant_race")</caption>
        <multiSelect>true</multiSelect>
        <table>CATISSUE_RACE</table>
        <column>RACE_NAME</column>
        <foreignKey>PARTICIPANT_ID</foreignKey>
        <parentKey>PARTICIPANT_ID</parentKey>
        <options>
          <sql>select value from catissue_permissible_value where public_id = 'race' order by sortorder</sql>
        </options>
      </checkBox>
    </row>
    <row>
      <textField>
        <name>ethnicity</name>
        <udn>ethnicity</udn>
        <caption>#getMessage("participant_ethnicity")</caption>
        <column>ETHNICITY</column>
      </textField>
    </row>
    <row>
      <subForm>
        <name>medicalRecord</name>
        <udn>medicalRecord</udn>
        <caption>#getMessage("participant_mrn")</caption>
        <table>CATISSUE_PART_MEDICAL_ID</table>
        <foreignKey>PARTICIPANT_ID</foreignKey>
        <parentKey>PARTICIPANT_ID</parentKey>
        <row>
          <numberField>
            <name>mrnSiteId</name>
            <udn>mrnSiteId</udn>
            <caption>#getMessage("participant_mrn_site_id")</caption>
            <column>SITE_ID</column>
            <recordUrl>#/object-state-params-resolver?stateName=site-detail.overview&amp;objectName=site&amp;key=id&amp;value={{$value}}</recordUrl>
          </numberField>
          <siteField>
            <name>mrnSiteName</name>
            <udn>mrnSiteName</udn>
            <caption>#getMessage("participant_mrn_site")</caption>
            <column>SITE_ID</column>
            <recordUrl>#/object-state-params-resolver?stateName=site-detail.overview&amp;objectName=site&amp;key=name&amp;value={{$value}}</recordUrl>
          </siteField>
          <textField>
            <name>medicalRecordNumber</name>
            <udn>medicalRecordNumber</udn>
            <caption>#getMessage("participant_mrn_mrn")</caption>
            <column>MEDICAL_RECORD_NUMBER</column>
            <maxLength>255</maxLength>
            <phi>true</phi>
          </textField>
        </row>
      </subForm>
    </row>
    <row>
      <textField>
        <name>barcode</name>
        <udn>barcode</udn>
        <caption>#getMessage("participant_barcode")</caption>
        <column>BARCODE</column>
      </textField>
    </row>
    <row>
      <numberField>
        <name>id</name>
        <udn>id</udn>
        <caption>#getMessage("cpr_id")</caption>
        <column>CPR_ID</column>
        <recordUrl>#/object-state-params-resolver?stateName=participant-detail.overview&amp;objectName=cpr&amp;key=id&amp;value={{$value}}</recordUrl>
      </numberField>
    </row>
    <row>
      <datePicker>
        <name>regDate</name>
        <udn>regDate</udn>
        <caption>#getMessage("participant_registration_date")</caption>
        <column>REGISTRATION_DATE</column>
        <format>MM-dd-yyyy</format>
        <phi>true</phi>
      </datePicker>
    </row>
    <row>
      <textField>
        <name>ppid</name>
        <udn>ppid</udn>
        <caption>#getMessage("participant_ppid")</caption>
        <column>PPID</column>
        <recordUrl>#/object-state-params-resolver?stateName=participant-detail.overview&amp;objectName=cpr&amp;key=id&amp;value={{$cprId}}</recordUrl>
      </textField>
    </row>
    <row>
      <subForm>
        <name>scgs</name>
        <udn>scgs</udn>
        <caption>#getMessage("participant_visits")</caption>
        <table>CATISSUE_SPECIMEN_COLL_GROUP</table>
        <foreignKey>COLLECTION_PROTOCOL_REG_ID</foreignKey>
        <parentKey>CPR_ID</parentKey>
        <pathLink>true</pathLink>
        <row>
          <subForm>
            <name>specimens</name>
            <udn>specimens</udn>
            <caption>#getMessage("participant_visits_specimens")</caption>
            <table>CATISSUE_SPECIMEN</table>
            <foreignKey>SPECIMEN_COLLECTION_GROUP_ID</foreignKey>
            <parentKey>IDENTIFIER</parentKey>
            <pathLink>true</pathLink>

            <row>
              <subForm>
                <name>specimenOrders</name>
                <udn>specimenOrders</udn>
                <caption>#getMessage("participant_visits_specimens_order_items")</caption>
                <table>OS_ORDER_ITEMS</table>
                <foreignKey>SPECIMEN_ID</foreignKey>
                <parentKey>IDENTIFIER</parentKey>
                <row>
                  <subForm>
                    <name>order</name>
                    <udn>order</udn>
                    <caption>#getMessage("participant_visits_specimens_order_items_order")</caption>
                    <table>OS_ORDERS</table>
                    <foreignKey>IDENTIFIER</foreignKey>
                    <parentKey>ORDER_ID</parentKey>
                  </subForm>
                </row>
              </subForm>
            </row>
            
            <row>
              <subForm>
                <name>specimenShipments</name>
                <udn>specimenShipments</udn>
                <caption>#getMessage("specimen_shipment_items")</caption>
                <table>OS_SHIPMENT_ITEMS</table>
                <foreignKey>SPECIMEN_ID</foreignKey>
                <parentKey>IDENTIFIER</parentKey>
                
                <row>
                  <subForm>
                    <name>shipment</name>
                    <udn>shipment</udn>
                    <caption>#getMessage("specimen_shipment_items_shipment")</caption>
                    <table>OS_SHIPMENTS</table>
                    <foreignKey>IDENTIFIER</foreignKey>
                    <parentKey>SHIPMENT_ID</parentKey>
                  </subForm>
                </row>
              </subForm>
            </row>
          </subForm>
        </row>
      </subForm>
    </row>
    <row>
      <subForm>
        <name>consentTier</name>
        <udn>consentTier</udn>
        <caption>#getMessage("participant_consent_tier")</caption>
        <table>CONSENT_TIER_VIEW</table>
        <foreignKey>CPR_ID</foreignKey>
        <parentKey>CPR_ID</parentKey>
        <row>
          <textField>
            <name>consentTierStatement</name>
            <udn>consentTierStatement</udn>
            <caption>#getMessage("participant_consent_tier_statement")</caption>
            <column>STATEMENT</column>
          </textField>

          <dropDown>
            <name>consentResponseStatement</name>
            <udn>consentResponseStatement</udn>
            <caption>#getMessage("participant_consent_tier_response")</caption>
            <column>RESPONSE</column>
            <options>
              <sql>select value from catissue_permissible_value where public_id = 'consent_response' order by sortorder</sql>
            </options>
          </dropDown>
        </row>
      </subForm>
    </row>
    <row>
      <datePicker>
        <name>consentSignDate</name>
        <udn>consentSignDate</udn>
        <caption>#getMessage("participant_consent_sign_date")</caption>
        <column>CONSENT_SIGN_DATE</column>
        <format>MM-dd-yyyy</format>
      </datePicker>
    </row>
    <row>  
      <userField>
        <name>consentWitness</name>
        <udn>consentWitness</udn>
        <caption>#getMessage("participant_consent_witness")</caption>
        <column>CONSENT_WITNESS</column>
      </userField>    
    </row>
    <row>
      <textField>
        <name>consentComments</name>
        <udn>consentComments</udn>
        <caption>#getMessage("participant_consent_comments")</caption>
        <column>CONSENT_COMMENTS</column>
        <maxLength>1000</maxLength>
      </textField>
    </row>
    <row>
      <subForm>
        <name>customFields</name>
        <udn>customFields</udn>
        <caption>#getMessage("participant_field_extensions")</caption>
        <table>OS_PART_CUST_FIELD_EXTNS_VIEW</table>
        <foreignKey>PID</foreignKey>
        <parentKey>PARTICIPANT_ID</parentKey>
        <pathLink>true</pathLink>
        <extnFkCol>RECORD_ID</extnFkCol>
      </subForm>
    </row>
    <row>
      <subForm>
        <name>extensions</name>
        <udn>extensions</udn>
        <caption>#getMessage("participant_extensions")</caption>
        <table>CPR_EXTENSION_RECORDS_VIEW</table>
        <foreignKey>CPR_ID</foreignKey>
        <parentKey>CPR_ID</parentKey>
        <pathLink>true</pathLink>
        <extnFkCol>RECORD_ID</extnFkCol>
      </subForm>
    </row>
    <row>
      <subForm>
        <name>visitCount</name>
        <udn>visitCount</udn>
        <caption>#getMessage("cpr_visit_count")</caption>
        <table>OS_CPR_VISIT_STATS_VIEW</table>
        <foreignKey>IDENTIFIER</foreignKey>
        <parentKey>CPR_ID</parentKey>
        <row>
          <numberField>
            <name>completedVisits</name>
            <udn>completedVisits</udn>
            <caption>#getMessage("number_of_visits_completed")</caption>
            <column>VISITS_COMPLETED</column>
          </numberField>
       
          <numberField>
            <name>missedVisits</name>
            <udn>missedVisits</udn>
            <caption>#getMessage("number_of_visits_missed")</caption>
            <column>VISITS_MISSED</column>
          </numberField>
      
          <numberField>
            <name>pendingVisits</name>
            <udn>pendingVisits</udn>
            <caption>#getMessage("number_of_visits_pending")</caption>
            <column>VISITS_PENDING</column>
          </numberField>
        </row>
      </subForm>
    </row>
    <row>
      <subForm>
        <name>specimenCount</name>
        <udn>specimenCount</udn>
        <caption>#getMessage("cpr_specimen_count")</caption>
        <table>OS_CPR_SPMN_STATS_VIEW</table>
        <foreignKey>IDENTIFIER</foreignKey>
        <parentKey>CPR_ID</parentKey>
        <row>
          <numberField>
            <name>collectedSpecimens</name>
            <udn>collectedSpecimens</udn>
            <caption>#getMessage("number_of_specimens_collected")</caption>
            <column>SPECIMENS_COLLECTED</column>
          </numberField>
       
          <numberField>
            <name>missedSpecimens</name>
            <udn>missedSpecimens</udn>
            <caption>#getMessage("number_of_specimens_missed")</caption>
            <column>SPECIMENS_MISSED</column>
          </numberField>
       
          <numberField>
            <name>pendingSpecimens</name>
            <udn>pendingSpecimens</udn>
            <caption>#getMessage("number_of_specimens_pending")</caption>
            <column>SPECIMENS_PENDING</column>
          </numberField>
        </row>
      </subForm>
    </row>
  </view>
</form>
